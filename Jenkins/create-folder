pipeline {
    agent { label 'linux' }  // SSH agent label

    parameters {
        string(
            name: 'githubConnection',
            defaultValue: 'github-creds',
            description: 'Jenkins Credential ID for GitHub'
        )
        string(
            name: 'GIT_REPO',
            defaultValue: 'https://github.com/IProgrammercube/software-installation.git',
            description: 'GitHub Repo URL'
        )
    }

    stages {

        stage('Checkout Main Branch') {
            steps {
                echo "Checking out main branch from repo: ${params.GIT_REPO}"
                git branch: 'main',
                    url: "${params.GIT_REPO}",
                    credentialsId: "${params.githubConnection}"
            }
        }

        stage('Run Folder Creation Script') {
            steps {
                echo "Running folder_creator.sh"
                dir('Jenkins/create-folder') {   // go into the folder where scripts are
                    sh 'chmod +x folder_creator.sh'   // ensure executable
                    sh './folder_creator.sh'
                }
            }
        }

        stage('Show Date') {
            steps {
                echo "Running show_date.sh"
                dir('Jenkins/create-folder') {
                    sh 'chmod +x show_date.sh'
                    sh './show_date.sh'
                }
            }
        }

        stage('List Folder Contents') {
            steps {
                echo "Listing contents of Jenkins/create-folder"
                sh 'ls -l Jenkins/create-folder'
            }
        }
    }

    post {
        success {
            echo "Pipeline completed successfully!"
        }
        failure {
            echo "Pipeline failed. Check logs above."
        }
    }
}
